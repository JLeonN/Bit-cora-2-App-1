### **M√≥dulo de Pedidos - Bit√°cora II**

Sistema completo para gesti√≥n de pedidos diarios con historial, exportaci√≥n, estad√≠sticas avanzadas y sistema gamificado de recompensas.

---

### üì¶ **Componentes Principales**

#### **TablaPedidos.vue**
- **Pantalla principal** del m√≥dulo de pedidos
- **Tabla de √∫ltimos 3 pedidos** realizados
- **Bot√≥n de estad√≠sticas anuales** (IconCalendarStats) en header
- **Integraci√≥n completa** con ContadorPedidosDiarios
- **Bot√≥n agregar** para abrir ModalNuevoPedido
- **Navegaci√≥n** a PedidosRealizados, HistorialPedidos y ResumenAnual
- **Responsive** con dise√±o adaptativo

#### **ModalNuevoPedido.vue**
- **Modal para agregar pedidos** manualmente
- **Input manual**: agrega un solo pedido y cierra autom√°ticamente
- **Bot√≥n de c√°mara**: abre CamaraPedidos.vue para escanear m√∫ltiples c√≥digos
- **Validaciones** con feedback visual
- **Integraci√≥n** con sistema de persistencia

#### **CamaraPedidos.vue**
- **Modal con c√°mara embebida** para escaneo en tiempo real
- **@zxing/library** para escaneo de c√≥digos de barra y QR
- **Miniatura de √∫ltima captura**
- **Lista de c√≥digos escaneados** con opci√≥n de eliminar
- **Botones**: finalizar (confirma todos), cancelar
- **Manejo de permisos** de c√°mara

#### **PedidosRealizados.vue**
- **Lista completa** de todos los pedidos guardados
- **Sistema de estad√≠sticas mensuales**: ResumenMensual integrado
- **Detecci√≥n de duplicados**: Contador y resaltado visual
- **Ordenados por fecha** (m√°s recientes primero)
- **Bot√≥n enviar Excel** con todos los pedidos
- **Acciones individuales**: editar y eliminar
- **Modal de edici√≥n** integrado
- **Filtros por rango de fechas** desde HistorialPedidos

#### **HistorialPedidos.vue**
- **Agrupaci√≥n de pedidos por mes y a√±o**
- **Vista expandible** por mes
- **Exportaci√≥n por mes** seleccionado
- **Bot√≥n enviar Excel** del mes
- **Contador de pedidos** por mes
- **Dise√±o tipo acorde√≥n**
- **Navegaci√≥n** a PedidosRealizados con filtro de mes

#### **‚úÖ ContadorPedidosDiarios.vue - Sistema Gamificado**
- **Contador autom√°tico** de pedidos del d√≠a actual
- **Reinicio a medianoche** autom√°tico (verificaci√≥n cada minuto)
- **Navegaci√≥n a estad√≠sticas**: Click en tarjeta abre EstadisticasPedidos
- **üéØ Sistema de recompensas**: Iconos din√°micos seg√∫n productividad
  - üìÖ **0 pedidos o 1-9 entre semana**
  - üëç **1-9 fin de semana o 10-19 entre semana**
  - üî• **20-29 pedidos**
  - ‚ö° **30-39 pedidos**
  - üå™Ô∏è **40-49 pedidos**
  - üíé **50+ pedidos**
- **L√≥gica diferenciada**: Fin de semana vs d√≠as laborables
- **Persistencia** entre sesiones con `@capacitor/preferences`
- **Actualizaci√≥n autom√°tica** al agregar pedidos
- **Icono de estad√≠sticas** en esquina superior derecha

---

### üìä **Sistema de Estad√≠sticas**

#### **PedidosDelDia.vue**
- **Pantalla de estad√≠sticas del d√≠a actual**
- **Tarjeta m√©trica gamificada**: Icono din√°mico seg√∫n cantidad
- **Tabla de pedidos del d√≠a**: Editar y eliminar
- **Contador de duplicados**: Detecci√≥n y alerta visual
- **Fecha formateada**: D√≠a completo en espa√±ol
- **Bot√≥n enviar**: Exporta pedidos del d√≠a en Excel
- **Actualizaci√≥n en tiempo real**: Refleja cambios inmediatos
- **Responsive**: Adaptado para m√≥viles

#### **ResumenMensual.vue**
- **4 tarjetas de m√©tricas**:
  - **Total de pedidos**: IconPackage
  - **D√≠as trabajados**: IconCalendarCheck
  - **Promedio por d√≠a**: Icono din√°mico seg√∫n valor
  - **Mejor d√≠a**: Icono din√°mico seg√∫n cantidad
- **Integrado en PedidosRealizados**: Se muestra al filtrar por mes
- **Iconos gamificados**: Usa obtenerIconoPorCantidad.js
- **Grid responsive**: 2 columnas en desktop, 1 en m√≥vil

#### **ResumenAnual.vue**
- **Estad√≠sticas completas del a√±o actual**
- **4 tarjetas de m√©tricas**:
  - **Total de pedidos del a√±o**
  - **Meses trabajados**: Con d√≠as totales trabajados
  - **Promedio por mes**: Icono din√°mico
  - **Mejor mes del a√±o**: Con mejor d√≠a del mes incluido
- **Navegaci√≥n desde TablaPedidos**: Bot√≥n IconCalendarStats
- **C√°lculo autom√°tico**: Agrupa por meses y d√≠as
- **Mejor d√≠a del mejor mes**: Detalle adicional en tarjeta
- **Mensaje vac√≠o**: Si no hay pedidos en el a√±o

#### **obtenerIconoPorCantidad.js**
- **M√≥dulo de l√≥gica de iconos gamificados**
- **Funci√≥n principal**: `obtenerIconoPorCantidad(cantidad)`
- **Funci√≥n especial para mejor d√≠a**: `obtenerIconoMejorDia(cantidad)` - usa IconTrophy si < 10
- **Funci√≥n especial para promedio**: `obtenerIconoPromedio(promedio)` - usa IconChartLine si < 10
- **Umbrales est√°ndar** (lunes a viernes):
  - 1-9: IconCalendarEvent
  - 10-19: IconThumbUp
  - 20-29: IconFlame
  - 30-39: IconBolt
  - 40-49: IconTornado
  - 50+: IconDiamond
- **Usado en**: ResumenMensual, ResumenAnual, PedidosDelDia, ContadorPedidosDiarios

---

### üìÅ **L√≥gica de Exportaci√≥n**

#### **ExportarPedidosExcel.js**
- **Generaci√≥n de Excel** con pedidos para descarga directa
- **Formato de nombre**: `Pedi Usuario - MM-AAAA.xlsx`
- **Nombre de hoja**: Nombre del usuario
- **Columnas**: Fecha, Pedido
- **Formato de fecha**: DD/MM/AAAA
- **Ordenamiento**: Por fecha descendente
- **Integraci√≥n** con nombre de usuario de configuraci√≥n
- **Anchos de columna**: 11 caracteres para ambas columnas

#### **GeneraExcel.js**
- **M√≥dulo reutilizable** para generar Excel temporal
- **Funci√≥n principal**: `generarYGuardarExcelTemporal(pedidos)`
- **C√°lculo autom√°tico de rango**: Fecha m√≠nima y m√°xima
- **Formato de nombre**: `Pedi Usuario DD-MM-AAAA - DD-MM-AAAA.xlsx`
- **Genera**: archivo Excel en memoria con `xlsx`
- **Guarda**: en `Directory.Cache` con `@capacitor/filesystem`
- **Retorna**: URI del archivo temporal y nombre
- **Formato**: Base64 para compatibilidad con Capacitor
- **Anchos de columna**: 11 caracteres para ambas columnas

#### **CompartirExcel.js**
- **Funci√≥n**: `compartirArchivo(rutaArchivo, nombreArchivo)`
- **Share API nativa** de Capacitor
- **T√≠tulo**: "Archivo Excel"
- **Compatible** con todas las apps de compartir del sistema
- **Manejo de errores**: Try-catch con console.error

---

### üíæ **Almacenamiento y Persistencia**

#### **usoAlmacenamientoPedidos.js**
- **M√≥dulo especializado** para pedidos
- **Funciones principales**:
  - `guardarPedidos(pedidos)`
  - `obtenerPedidos()`
  - `agregarPedido(codigo)`
  - `eliminarPedido(id)`
  - `editarPedido(id, nuevoCodigo)`
  - `limpiarPedidos()`
  - `guardarFechaUltimoEnvio(fecha)`
- **Estructura de pedido**: `{ numero, fecha }`
- **Persistencia** en `@capacitor/preferences`
- **Key**: `"pedidos"`

---

### üéØ **Sistema de Logros Gamificado**

- **Detecci√≥n autom√°tica** de fin de semana (s√°bado/domingo)
- **Umbrales diferentes** seg√∫n d√≠a de la semana
- **Reconocimiento cada 10 pedidos** con cambio de icono
- **Persistencia del contador** durante todo el d√≠a
- **Reset autom√°tico** a las 00:00
- **Mensajes motivacionales** diferenciados
- **Navegaci√≥n a estad√≠sticas**: Click en contador abre PedidosDelDia
- **Iconograf√≠a de @tabler/icons-vue**

---

### üîÑ **Integraci√≥n con Barra de Botones**

#### **TablaPedidos.vue**
- `mostrarAtras: true`
- `mostrarInicio: true`
- `mostrarAgregar: true`
- `mostrarEnviar: false`

#### **PedidosRealizados.vue**
- `mostrarAtras: true`
- `mostrarInicio: true`
- `mostrarAgregar: false`
- `mostrarEnviar: pedidos.length > 0`

#### **PedidosDelDia.vue**
- `mostrarAtras: true`
- `mostrarInicio: true`
- `mostrarAgregar: false`
- `mostrarEnviar: pedidosDelDia.length > 0`

#### **ResumenAnual.vue**
- `mostrarAtras: true`
- `mostrarInicio: true`
- `mostrarAgregar: false`
- `mostrarEnviar: false`

#### **HistorialPedidos.vue**
- `mostrarAtras: true`
- `mostrarInicio: true`
- `mostrarAgregar: false`
- `mostrarEnviar: false`

---

### üé® **Caracter√≠sticas de UI/UX**

- **Tabla responsive** con dise√±o de cards en m√≥vil
- **Animaciones suaves** en transiciones
- **Feedback visual** inmediato
- **Iconos consistentes** con @tabler/icons-vue
- **Estados de carga** con spinners
- **Notificaciones** de √©xito/error con Quasar Notify
- **Confirmaciones** antes de acciones destructivas
- **Colores tem√°ticos** seg√∫n logro alcanzado
- **Detecci√≥n de duplicados**: Resaltado visual en tablas
- **Tarjetas m√©tricas**: Grid responsivo con hover effects
- **Iconos din√°micos**: Cambian seg√∫n progreso del usuario

---

### üîß **Dependencias Espec√≠ficas**

- **xlsx**: Generaci√≥n de archivos Excel
- **@capacitor/filesystem**: Guardado de archivos
- **@capacitor/share**: Compartir archivos
- **@capacitor/preferences**: Persistencia de datos
- **@zxing/library**: Escaneo de c√≥digos
- **@tabler/icons-vue**: Iconograf√≠a completa

---

### üó∫Ô∏è **Navegaci√≥n del M√≥dulo**

```
TablaPedidos (/)
‚îú‚îÄ‚îÄ ContadorPedidosDiarios ‚Üí EstadisticasPedidos (PedidosDelDia)
‚îú‚îÄ‚îÄ Bot√≥n Estad√≠sticas Anuales ‚Üí ResumenAnual
‚îú‚îÄ‚îÄ Agregar ‚Üí ModalNuevoPedido ‚Üí CamaraPedidos
‚îî‚îÄ‚îÄ HistorialPedidos
    ‚îî‚îÄ‚îÄ Click en Mes ‚Üí PedidosRealizados (con filtro)
        ‚îî‚îÄ‚îÄ ResumenMensual (integrado)
```

---

### üìù **Notas Importantes**

- Los pedidos se guardan **autom√°ticamente** al agregarlos
- El contador diario se **resetea solo** a medianoche
- Los archivos Excel se generan en **memoria** y se guardan temporalmente
- El **nombre de usuario** de configuraci√≥n se integra en nombres de archivo
- El sistema de logros **motiva** la productividad sin ser intrusivo
- Las **estad√≠sticas se calculan en tiempo real** al cargar cada componente
- Los **duplicados se detectan autom√°ticamente** por n√∫mero de pedido
- La **navegaci√≥n entre vistas** preserva el contexto y permite regresar f√°cilmente